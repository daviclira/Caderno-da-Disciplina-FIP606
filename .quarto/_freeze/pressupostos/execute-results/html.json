{
  "hash": "ad9ad5b61b553b7ff82e2c9838bc8ece",
  "result": {
    "markdown": "# Testar Pressupostos Estatísticos\n\nOs principais pressupostos estatísticos são:\n\n-   Normalidade dos resíduos\n\n-   Homocedasticidade (variância constante)\n\n-   Independência das observações\n\nAvaliar esses pressupostos é importante para escolher o teste estatístico mais adequado para descrever seus dados. Isso garante a validade dos resultados obtidos, através de uma maior precisão das conclusões obtidas e da robustez da análise.\n\n## Testar a normalidade dos resíduos\n\nPara testar a normalidade dos resíduos, podemos fazer através de análise gráfica (forma visual), e através de testes próprios para isso. A união dos dois métodos é interessante para uma maior certeza do resultado.\n\n### Análise gráfica\n\n::: callout-note\n##### Pacote *datasets*\n\nDescrição: Pacote base do R contendo conjuntos de dados clássicos para demonstração e aprendizado. Uso: Fornece exemplos prontos para prática de análise estatística, visualização e modelagem.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!require(datasets)) install.packages(\"datasets\")\nlibrary(datasets)\n\ninsect <- InsectSprays\n\nm2 <- lm(count ~ spray, data = insect)\n\nhist(residuals(m2))\n```\n\n::: {.cell-output-display}\n![](pressupostos_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(residuals(m2))\n```\n\n::: {.cell-output-display}\n![](pressupostos_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Quanto mais próximos da distribuição diagonal, maior é a chance da normalidade ser presente\n```\n:::\n\n\n### Análise com testes\n\nExistem vários testes para analisar a normalidade dos resíduos de um modelo, um exemplo deles é o teste de Shapiro-Wilk O teste de Shapiro-Wilk assume como hipóteses estatísticas: - H0 = Dados seguem a distribuição normal - H1 = Dados não seguem a distribuição normal Ou seja, para valores p menores ou iguais ao alfa estipulado, os dados não seguem a normalidade. E, para valores p maiores que o alfa estipulado, os dados seguem a normalidade.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(residuals(m2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(m2)\nW = 0.96006, p-value = 0.02226\n```\n:::\n:::\n\n\nTeste para normaldiade de resíduos com o pacote *DHARMa*\n\n::: callout-note\n##### Pacote *DHARMa*\n\nDescrição: Ferramentas para diagnóstico de modelos estatísticos, especialmente GLMMs.\\\nUso: Gera resíduos simulados para verificar a adequação de modelos.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!require(DHARMa)) install.packages(\"DHARMa\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: DHARMa\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'DHARMa' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in check_dep_version(): ABI version mismatch: \nlme4 was built with Matrix ABI version 1\nCurrent Matrix ABI version is 0\nPlease re-install lme4 from source or restore original 'Matrix' package\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThis is DHARMa 0.4.7. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')\n```\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\n\nm2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = count ~ spray, data = insect)\n\nCoefficients:\n(Intercept)       sprayB       sprayC       sprayD       sprayE       sprayF  \n    14.5000       0.8333     -12.4167      -9.5833     -11.0000       2.1667  \n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m2))\n```\n\n::: {.cell-output-display}\n![](pressupostos_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Com esse comando, você pode avaliar normalidade e homocedasticidade de forma conjunta e prática\n```\n:::\n\n\n## Testar a homocedasticidade\n\nPara testar a homogeneidade das variâncias, podemos fazer através de análise gráfica (forma visual), e através de testes próprios para isso. A união dos dois métodos é interessante para uma maior certeza do resultado.\n\n### Análise gráfica\n\n#### Gráfico de Resíduos vs. Valores Ajustados\n\nMelhor para modelos lineares\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2 <- lm(count ~ spray, data = insect)\nplot(m2, which = 1) \n```\n\n::: {.cell-output-display}\n![](pressupostos_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n#### Boxplot por Grupo\n\nMelhor para comparação entre grupos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!require(ggplot2)) install.packages(\"ggplot2\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: ggplot2\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nggplot(insect, aes(x = spray, y = count)) +\n  geom_boxplot() +\n  labs(title = \"Variabilidade entre Grupos\")\n```\n\n::: {.cell-output-display}\n![](pressupostos_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n### Análise com testes\n\nGeralmente, os testes de homocedasticidade tem as hipóteses estatísticas seguindo o mesmo padrão dos testes de normalidade citados As hipóteses estatísticas normalmente são: - H0 = Dados apresentam variâncias homogêneas - H1 = Dados não apresentam variâncias homogêneas\n\nExistem vários testes para avaliar a homogeneidade de variâncias de modelos, aqui exemplificamos dois bastante utilizados.\n\n#### Teste F para comparar duas variâncias\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!require(readxl)) install.packages(\"readxl\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: readxl\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'readxl' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(readxl)\nif(!require(tidyr)) install.packages(\"tidyr\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: tidyr\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidyr' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyr)\nif(!require(dplyr)) install.packages(\"dplyr\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: dplyr\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'dplyr' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n\nmg<- read_excel(\"dados-diversos.xlsx\",\n                       sheet = \"magnesio\")\n\nmg2 <- mg |>  \n  pivot_wider(names_from = trat, values_from = comp) |> \n    select(-rep)\n\nvar.test(mg2$Mg2, mg2$control)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tF test to compare two variances\n\ndata:  mg2$Mg2 and mg2$control\nF = 1.4781, num df = 9, denom df = 9, p-value = 0.5698\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.3671417 5.9508644\nsample estimates:\nratio of variances \n          1.478111 \n```\n:::\n:::\n\n\n#### Teste de Bartlett\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!require(datasets)) install.packages(\"datasets\")\nlibrary(datasets)\n\ninsect <- InsectSprays\n\nbartlett.test(count ~ spray, data = insect)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count by spray\nBartlett's K-squared = 25.96, df = 5, p-value = 9.085e-05\n```\n:::\n:::\n",
    "supporting": [
      "pressupostos_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}