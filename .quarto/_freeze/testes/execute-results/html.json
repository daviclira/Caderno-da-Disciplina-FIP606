{
  "hash": "227ed25daff425ccbffedcfe901ebe00",
  "result": {
    "markdown": "# Testes estatísticos\n\nOs testes estatísticos são ferramentas utilizadas para tomar decisões com base em dados, avaliando hipóteses e determinando se as diferenças ou relações observadas são estatisticamente significativas ou se podem ter ocorrido por acaso.\n\nPodemos utilizar uma enorme variedade de testes para analisar nossos dados. A escolha do melhor teste depende do tipo de dados a serem analisados, a distribuição dos dados, dos pressupostos atingidos ou não atingidos, entre outros fatores.\n\nOs testes podem ser divididos de forma geral entre *paramétricos* e *não paramétricos*.\n\n## Testes paramétricos\n\nPressupõem que os resíduos do modelo seguem uma distribuição normal, e apresentam homogeneidade de variâncias.\n\n### Teste T\n\nCompara médias de dois grupos.\\\nPode ser utilizado em vários tipos\n\n#### Teste T para amostras independentes: 2 grupos não relacionados.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!require(readxl)) install.packages(\"readxl\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: readxl\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'readxl' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(readxl)\nif(!require(tidyr)) install.packages(\"tidyr\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: tidyr\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidyr' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyr)\nif(!require(dplyr)) install.packages(\"dplyr\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: dplyr\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'dplyr' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n\nmg<- read_excel(\"dados-diversos.xlsx\",\n                       sheet = \"magnesio\")\n\nmg2 <- mg |>  \n  pivot_wider(names_from = trat, values_from = comp) |> \n    select(-rep)\n\n\ntmg2 <- t.test(mg2$Mg2, mg2$control)\n```\n:::\n\n\n#### Teste T pareado: Mesmos indivíduos em dois momentos.\n\n::: callout-note\n##### Pacote *rstatix*\n\nDescrição: Funções relacionadas ao grupo \"tidy\" para estatística descritiva e testes. Uso: Realizar testes como Wilcoxon ou Kruskal-Wallis em pipelines (%\\>%).\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!require(rstatix)) install.packages(\"rstatix\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: rstatix\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'rstatix' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'rstatix'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n:::\n\n```{.r .cell-code}\nlibrary(rstatix)\n\nescala <- read_excel(\"dados-diversos.xlsx\",\n                       sheet = \"escala\")\n\nt_test(acuracia ~ assessment, \n       data = escala, \n       paired = T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 8\n  .y.      group1 group2     n1    n2 statistic    df       p\n* <chr>    <chr>  <chr>   <int> <int>     <dbl> <dbl>   <dbl>\n1 acuracia Aided1 Unaided    10    10      4.43     9 0.00166\n```\n:::\n:::\n\n\n#### Teste T para uma amostra: Compara média da amostra com um valor fixo\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiversos <- read_excel(\"dados-diversos.xlsx\")\n\nteste_t <- t.test(diversos$ImageJ, mu = 500)\nprint(teste_t)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne Sample t-test\n\ndata:  diversos$ImageJ\nt = -172.55, df = 69, p-value < 2.2e-16\nalternative hypothesis: true mean is not equal to 500\n95 percent confidence interval:\n 12.82394 23.96006\nsample estimates:\nmean of x \n   18.392 \n```\n:::\n:::\n\n\n### Regressão Linear\n\nModela a relação entre uma variável dependente (contínua) e uma ou mais variáveis independentes (contínuas).\\\nObjetivo: Prever ou explicar o comportamento da variável resposta. Para isso, usaremos a função \"lm\", nativa do R.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfungcamp<- read_excel(\"dados-diversos.xlsx\",\n                       sheet = \"fungicida_campo\")\n\nlinearmodel <- lm(PROD ~ FER, data = fungcamp)\nsummary(linearmodel)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = PROD ~ FER, data = fungcamp)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-983.83 -182.07   27.37  261.10  591.92 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  5286.09      91.66  57.672  < 2e-16 ***\nFER           -49.60      11.28  -4.396 0.000127 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 363.2 on 30 degrees of freedom\nMultiple R-squared:  0.3918,\tAdjusted R-squared:  0.3715 \nF-statistic: 19.32 on 1 and 30 DF,  p-value: 0.0001274\n```\n:::\n\n```{.r .cell-code}\n# Identificar o valor dos coeficientes beta-0 e beta-1\nprint(linearmodel)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = PROD ~ FER, data = fungcamp)\n\nCoefficients:\n(Intercept)          FER  \n     5286.1        -49.6  \n```\n:::\n:::\n\n\n### ANOVA (Análise de Variância)\n\nCompara médias de três ou mais grupos para verificar diferenças estatísticas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmicelial <- read_excel(\"dados-diversos.xlsx\",\n                       sheet = \"micelial\")\n\nanova <- aov(tcm ~ especie, data = micelial)\n\nsummary(anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \nespecie      4 1.4696  0.3674   19.63 2.03e-07 ***\nResiduals   25 0.4679  0.0187                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nprint(anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\n   aov(formula = tcm ~ especie, data = micelial)\n\nTerms:\n                  especie Residuals\nSum of Squares  1.4695800 0.4679167\nDeg. of Freedom         4        25\n\nResidual standard error: 0.1368089\nEstimated effects may be unbalanced\n```\n:::\n:::\n\n\n### ANCOVA (Análise de Covariância)\n\nCombina ANOVA e regressão linear.\\\nO objetivo é ajustar o efeito de variáveis contínuas (covariáveis) ao comparar grupos\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncurve <- read_excel(\"dados-diversos.xlsx\",\n                       sheet = \"curve\")\n\nancova <- aov(severity ~ Irrigation + day + Irrigation*day, data = curve)\n\nsummary(ancova)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               Df Sum Sq Mean Sq  F value Pr(>F)    \nIrrigation      1 0.0006  0.0006    0.557  0.458    \nday             1 1.3360  1.3360 1151.037 <2e-16 ***\nIrrigation:day  1 0.0007  0.0007    0.628  0.432    \nResiduals      56 0.0650  0.0012                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n# Quando a interação não for significativa, deve-se retirá-la do modelo e roda-lo novamente.\n\nancova <- aov(severity ~ Irrigation + day, data = curve)\n\nsummary(ancova)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq  F value Pr(>F)    \nIrrigation   1 0.0006  0.0006    0.561  0.457    \nday          1 1.3360  1.3360 1158.607 <2e-16 ***\nResiduals   57 0.0657  0.0012                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n### ANOVA bifatorial\n\nA ANOVA bifatorial (ou ANOVA Two-Way) é um teste estatístico que avalia o efeito de dois fatores *categóricos independentes* sobre uma variável *contínua dependente*, além de verificar se há interação entre os fatores.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsensi <- read_excel(\"dados-diversos.xlsx\",\n                       sheet = \"sensibilidade_fungicidas\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\n• `` -> `...8`\n• `` -> `...9`\n```\n:::\n\n```{.r .cell-code}\nmodsensi <- aov(germination ~ state * dose, data = sensi)\nsummary(modsensi)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Df Sum Sq Mean Sq F value Pr(>F)    \nstate         1     18      18   0.613  0.434    \ndose          5  81188   16238 548.446 <2e-16 ***\nstate:dose    5    215      43   1.451  0.207    \nResiduals   228   6750      30                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Testes não paramétricos\n\nSão testes que não exigem suposições rígidas sobre a distribuição dos dados.\n\n### Kruskal-Wallis\n\nANOVA não paramétrica para comparar medianas de três ou mais grupos independentes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!require(datasets)) install.packages(\"datasets\")\nlibrary(datasets)\n\ninsect <- InsectSprays\n\nkruskal.test(count ~ spray, data = insect)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  count by spray\nKruskal-Wallis chi-squared = 54.691, df = 5, p-value = 1.511e-10\n```\n:::\n:::\n\n\nO pacote agricolae tem teste kruskal já mostrando os grupos que diferem\n\n::: callout-note\n##### Pacote *agricolae*\n\n*Descrição*: Apresenta funções estatísticas relacionadas a experimentos agrícolas.\\\n*Uso*: ANOVA, testes de médias (Duncan, LSD), delineamentos experimentais.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!require(agricolae)) install.packages(\"agricolae\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: agricolae\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'agricolae' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(agricolae)\n\nkruskal(insect$count, insect$spray, group = T, console = T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: insect$count ~ insect$spray\nKruskal-Wallis test's\nTies or no Ties\n\nCritical Value: 54.69134\nDegrees of freedom: 5\nPvalue Chisq  : 1.510845e-10 \n\ninsect$spray,  means of the ranks\n\n  insect.count  r\nA     52.16667 12\nB     54.83333 12\nC     11.45833 12\nD     25.58333 12\nE     19.33333 12\nF     55.62500 12\n\nPost Hoc Analysis\n\nt-Student: 1.996564\nAlpha    : 0.05\nMinimum Significant Difference: 8.462804 \n\nTreatments with the same letter are not significantly different.\n\n  insect$count groups\nF     55.62500      a\nB     54.83333      a\nA     52.16667      a\nD     25.58333      b\nE     19.33333     bc\nC     11.45833      c\n```\n:::\n:::\n\n\n### Teste de Wilcoxon\n\nVersão não paramétrica para comparar duas amostras pareadas (dados não normais).\\\n*Versões*:\\\n- *Wilcoxon signed-rank*: Amostras dependentes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nescala <- read_excel(\"dados-diversos.xlsx\",\n                       sheet = \"escala\")\n\nunaided <- escala |> \n  filter(assessment == \"Unaided\") |> \n  select(acuracia) |> \n  pull()\n\naided <- escala |> \n  filter(assessment == \"Aided1\") |> \n  select(acuracia) |> \n  pull()\n\nwilcox.test(unaided, aided)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon rank sum exact test\n\ndata:  unaided and aided\nW = 0, p-value = 1.083e-05\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n\n-   *Wilcoxon rank-sum (Mann-Whitney U)*: Amostras independentes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(unaided, aided, paired = F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon rank sum exact test\n\ndata:  unaided and aided\nW = 0, p-value = 1.083e-05\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n\n### GLM (Modelos Lineares Generalizados)\\*\n\nEstende a regressão linear para variáveis resposta não normais.\\\nComponentes:\\\n\n*Família de distribuições*:\\\n- *Gaussiana (normal)*: Para dados contínuos.\\\n- *Binomial*: Para proporções/binários\\\n- *Poisson*: Para contagens\\\n- *Gamma*: Para dados contínuos assimétricos\n\n*Função de ligação*: Conecta preditores à resposta (ex.: logit para binomial).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglm <- glm(PROD ~ FER, data = fungcamp)\n\nsummary(glm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = PROD ~ FER, data = fungcamp)\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  5286.09      91.66  57.672  < 2e-16 ***\nFER           -49.60      11.28  -4.396 0.000127 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 131911.9)\n\n    Null deviance: 6506243  on 31  degrees of freedom\nResidual deviance: 3957358  on 30  degrees of freedom\nAIC: 472.02\n\nNumber of Fisher Scoring iterations: 2\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}